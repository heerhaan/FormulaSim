@model FormuleCirkelEntity.ViewModels.DriverTraitsModel

@{
    ViewData["Title"] = "Traits for team";
}

<div class="d-inline-block w-60">
    <h1>Traits for @Html.DisplayFor(modelItem => modelItem.Driver.Name)</h1>

    <h3>Applied traits</h3>
    <table class="ctable fullborder fullwidth">
        <thead class="fullborder">
            <tr>
                <th class="w-20">Trait</th>
                <th class="w-60">Description</th>
                <th class="w-10">Info</th>
                <th class="w-10"></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var trait in Model.DriverTraits)
            {
                <tr>
                    <td>
                        @trait.Name
                    </td>
                    <td class="text-left">
                        <span class="ml-cel">@trait.TraitDescription</span>
                    </td>
                    <td>
                        <a asp-controller="Traits" asp-action="Info" asp-route-id="@trait.TraitId"><i class="fas fa-info-circle fa-2x"></i></a>
                    </td>
                    <td>
                        <a asp-controller="Drivers" asp-action="RemoveDriverTrait" asp-route-driverId="@Model.Driver.Id" asp-route-traitId="@trait.TraitId" class="btn fullwidth fullborder">Remove</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <h3>Add traits</h3>
    <div class="flex-row justify-content-between mb-1">
        <form method="POST">
            <input id="randomInput" type="hidden" name="traitId" />
            <input id="randomSubmit" type="submit" class="btn fullwidth" value="Random" />
        </form>
        <a asp-controller="Traits" asp-action="Create" class="btn">New trait</a>
    </div>
    <table class="ctable fullborder fullwidth">
        <thead class="fullborder">
            <tr>
                <th class="w-20">Trait</th>
                <th class="w-60">Description</th>
                <th class="w-10">Info</th>
                <th class="w-10"></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var trait in Model.Traits)
            {
                <tr>
                    <td>
                        @trait.Name
                    </td>
                    <td class="text-left">
                        <span class="ml-cel">@trait.TraitDescription</span>
                    </td>
                    <td>
                        <a asp-controller="Traits" asp-action="Info" asp-route-id="@trait.TraitId"><i class="fas fa-info-circle fa-2x"></i></a>
                    </td>
                    <td>
                        <form method="POST">
                            <input type="hidden" name="traitId" value="@trait.TraitId" />
                            <input type="submit" class="btn fullwidth fullborder" value="Add" />
                        </form>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <div class="float-left">
        <a class="btn" asp-action="Index">
            <i class="fas fa-arrow-alt-circle-left"></i> Back
        </a>
    </div>
</div>

<script>
    window.onload = function () {
        var traits = @(Json.Serialize(Model.Traits.Select(t => t.TraitId)));
        if (traits.length == 0) {
            document.getElementById("randomSubmit").style.display = "none";
        }
        else {
            const randomId = traits[Math.floor(Math.random() * traits.length)];
            document.getElementById("randomInput").value = randomId;
        }
    }
</script>
